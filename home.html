<div class="container-lg px-3 my-5 markdown-body">
	<h1 id="title"></h1>
	<p>
		<div id="videoPlayer"></div>
	</p>
	<p>本次打开：<span id="timer"></span></p>
	<p>缓存代码：<span id="code"></span></p>
	<p>UserAgent：<span id="ua"></span></p>
	<p>设备信息：<span id="info"></span></p>
	<p>
		<input type="file" accept="image/*" onchange="handleFileSelect(event)">
	</p>
	<p>
		<div id="guessResult"></div>
	</p>
	<p><textarea id="RResult" rows="3" cols="40" placeholder="输入数字，游玩猜数字游戏；粘贴接龙数据，转换为不带序号的一行数据；粘贴视频链接，生成在线播放器"></textarea>
	</p>
	<p>
		<button onclick="提交猜测()" id="submitDiv">猜测</button>
		<button onclick="猜数字()">游戏重置</button>
		<button onclick="convertData()">转换</button>
		<button onclick="playVideo()">加载</button>
	</p>
	<p>
		<div style="display: flex; align-items: center;">
			<button id="prevButton" onclick="prevSong()" style="border: none; background-color: transparent; padding: 5px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"><path d="M19.2659255,6.65608891 C19.4195201,6.92212253 19.5003811,7.22389975 19.5003811,7.53108891 L19.5003811,16.4689111 C19.5003811,17.4354094 18.7168794,18.2189111 17.7503811,18.2189111 C17.4431919,18.2189111 17.1414147,18.1380501 16.8753811,17.9844555 L9.135,13.5155445 C8.29798791,13.0322953 8.01120639,11.9620121 8.49445554,11.125 C8.64805012,10.8589664 8.86896638,10.6380501 9.135,10.4844555 L16.8753811,6.01554446 C17.7123931,5.5322953 18.7826764,5.81907682 19.2659255,6.65608891 Z M5,6.25 C5.55228475,6.25 6,6.69771525 6,7.25 L6,7.25 L6,16.75 C6,17.3022847 5.55228475,17.75 5,17.75 C4.44771525,17.75 4,17.3022847 4,16.75 L4,16.75 L4,7.25 C4,6.69771525 4.44771525,6.25 5,6.25 Z" id="_____path-1"/></svg></button>
			<button id="skipButton" onclick="nextSong()" style="border: none; background-color: transparent; padding: 5px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"><path d="M4.73445554,6.65608891 C5.2177047,5.81907682 6.28798791,5.5322953 7.125,6.01554446 L7.125,6.01554446 L14.8653811,10.4844555 C15.1314147,10.6380501 15.3523309,10.8589664 15.5059255,11.125 C15.9891747,11.9620121 15.7023931,13.0322953 14.8653811,13.5155445 L14.8653811,13.5155445 L7.125,17.9844555 C6.85896638,18.1380501 6.55718916,18.2189111 6.25,18.2189111 C5.28350169,18.2189111 4.5,17.4354094 4.5,16.4689111 L4.5,16.4689111 L4.5,7.53108891 C4.5,7.22389975 4.58086096,6.92212253 4.73445554,6.65608891 Z M18.25,6.25 C18.8022847,6.25 19.25,6.69771525 19.25,7.25 L19.25,16.75 C19.25,17.3022847 18.8022847,17.75 18.25,17.75 C17.6977153,17.75 17.25,17.3022847 17.25,16.75 L17.25,7.25 C17.25,6.69771525 17.6977153,6.25 18.25,6.25 Z" id="__path-1"/></svg></button>
			<button id="randomButton" onclick="toggleRandom()" style="border: none; background-color: transparent; padding: 5px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"> <path d="M21.5428932,14.5 C21.6755015,14.5 21.8026784,14.5526784 21.8964466,14.6464466 C22.0917088,14.8417088 22.0917088,15.1582912 21.8964466,15.3535534 L21.8964466,15.3535534 L19.6035534,17.6464466 C19.5097852,17.7402148 19.3826082,17.7928932 19.25,17.7928932 C18.9738576,17.7928932 18.75,17.5690356 18.75,17.2928932 L18.75,17.2928932 L18.75,15.9991068 L2.75,16 C2.37030423,16 2.05650904,15.7178461 2.00684662,15.3517706 L2,15.25 C2,14.8357864 2.33578644,14.5 2.75,14.5 L2.75,14.5 Z M19.25,6.45710678 C19.3826082,6.45710678 19.5097852,6.5097852 19.6035534,6.60355339 L21.8964466,8.89644661 C22.0917088,9.09170876 22.0917088,9.40829124 21.8964466,9.60355339 C21.8026784,9.69732158 21.6755015,9.75 21.5428932,9.75 L2.75,9.75 C2.33578644,9.75 2,9.41421356 2,9 C2,8.58578644 2.33578644,8.25 2.75,8.25 L18.75,8.24910678 L18.75,6.95710678 C18.75,6.68096441 18.9738576,6.45710678 19.25,6.45710678 Z" id="__path-1"/></svg></button>
			<input type="time" id="scheduleTime" value="" style="margin-left: 10px;" ontouchstart="startTimer()" ontouchend="endTimer()"
				onmousedown="startTimer()" onmouseup="endTimer()">
				<input type="checkbox" id="myCheckbox" style="margin-left: 10px;">
				<button id="loadCacheButton" onclick="loadCache()" style="border: none; background-color: transparent; padding: 5px;"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"><path d="M22.3414769,15.7576235 C22.3414769,15.7576235 22.3414769,15.7576235 22.3414769,15.7576235 C22.7675941,14.58516 23,13.3197207 23,12 L20.148111,12 C19.8719687,12 19.648111,12.2238576 19.648111,12.5 C19.648111,12.5930667 19.6740858,12.6842863 19.7231119,12.7633928 L21.6247463,15.831787 C21.7412468,16.0197728 21.9880826,16.0777198 22.1760669,15.9612167 C22.2524981,15.9138485 22.3107624,15.8421345 22.3414769,15.7576235 Z M22.823695,13.9714637 C22.9406935,13.3251822 23,12.6661847 23,12 C23,5.92486775 18.0751322,1 12,1 C11.2174632,1 10.44502,1.08183322 9.69172269,1.24274766 C4.65590569,2.31846601 1,6.78563595 1,12 C1,18.0751322 5.92486775,23 12,23 C13.0917435,23 14.1629676,22.8407032 15.1884731,22.530585 C16.7020101,22.0728837 18.0947944,21.2926603 19.2766337,20.2494437 C19.5871723,19.9753294 19.6167001,19.5013746 19.3425858,19.190836 C19.0684716,18.8802974 18.5945167,18.8507696 18.2839781,19.1248839 C17.2629258,20.0261728 16.0603686,20.6998329 14.7542841,21.0947995 C13.8691955,21.3624549 12.9442454,21.5 12,21.5 C6.75329488,21.5 2.5,17.2467051 2.5,12 C2.5,7.496884 5.65786226,3.63827588 10.0050734,2.70965302 C10.6555297,2.57070679 11.322948,2.5 12,2.5 C17.2467051,2.5 21.5,6.75329488 21.5,12 C21.5,12.5764741 21.4487412,13.1460473 21.3476867,13.7042571 C21.2738996,14.1118455 21.544499,14.5020775 21.9520875,14.5758645 C22.3596759,14.6496516 22.7499079,14.3790522 22.823695,13.9714637 Z" id="_path-1"/></svg></button>
		</div>
	</p>
	<p>
		<audio id="audio" controls></audio>
	</p>
	<p>
		<div class="container1">
			<div class="item">
				<img id="image" alt="歌曲配图" style="max-width: 400px; max-height: 600px; width: auto; height: auto;" src="">
			</div>
			<div class="item">
				<table id="songList" style="height: 500px; overflow: auto;">
					<thead>
						<tr>
							<th>播放列表</th>
						</tr>
					</thead>
					<tbody>
					</tbody>
				</table>
			</div>
		</div>
		<div style="text-align: center;">
			<div id="photo">
				<img src="assets/image/icon.png" alt="icon" id="icon">
				<div id="time"></div>
			</div>
			<br>
			<button id="capture">保存</button>
		</div>
	</p>
</div>

<script>
	// 页面进入初始化
     document.addEventListener("DOMContentLoaded", function() {
     	setInterval(checkSchedule, 1000);
     	generateList();
     	猜数字();
     	updateSong(false);
     	loadPlaybackStatus();
     });

// 列表数据
     const songspre = [
    { src: "1s无声", img: "music.webp", directLink: "" }, 
    ];
    const songs = songspre.map(song => {
        if (song.directLink) {
            return {
                src: song.directLink,
                img: `assets/image/${song.img}`
            };
        } else {
            return {
                src: `assets/music/${song.src}.mp3`,
                img: `assets/image/${song.img}`
            };
        }
    });
     const imagespre = [
            { img: "avatar.png" },
            { img: "icon.png" },
	 ];
	 const images = imagespre.map(image => ({
		    img: `assets/image/${image.img}`
	 }));
     const docuspre = [
            { src: "广州七中初中2019级.xlsx" },
	 ];
	 const docus = docuspre.map(docu => ({
		    src: `https://ow365.cn/?i=33666&ssl=1&furl=https://sunnyhmz.top:8888/assets/document/${docu.src}`
	 }));

// icon展示及水印生成（包含icon隐藏入口）（联动猜数字游戏作弊）
    var 保密 = "";
    var clickCount = 0;
    
    document.getElementById("icon")
    	.addEventListener("click", () => {
    		clickCount++;
    		if (clickCount === 5) {
    			var password = prompt("请输入密码：");
    			if (password === null) {
    				clickCount = 0;
    				return;
    			}
    			if (password === "haha") {
    				保密 = "1";
    				document.addEventListener("mousedown", function(event) {
    					document.getElementById("icon")
    						.src = "";
    				});
    				document.addEventListener("mouseup", function(event) {
    					document.getElementById("icon")
    						.src = "assets/image/icon.png";
    				});
    				document.addEventListener("touchstart", function(event) {
    					document.getElementById("icon")
    						.src = "";
    				});
    				document.addEventListener("touchend", function(event) {
    					document.getElementById("icon")
    						.src = "assets/image/icon.png";
    				});
    			} else {
    				clickCount = 0;
    				alert("密码错误");
    			}
    			clickCount = 0;
    		}
    	});

    document.getElementById("capture")
    	.addEventListener("click", () => {
    		const now = new Date();
    		const month = now.getMonth() + 1;
    		const date = now.getDate();
    		const formattedMonth = month < 10 ? `0${month}` : month;
    		const formattedDate = date < 10 ? `0${date}` : date;
    		const formattedTime = `${now.getFullYear()}${formattedMonth}${formattedDate}`;
    		html2canvas(document.getElementById("photo"))
    			.then(canvas => {
    				const croppedCanvas = document.createElement("canvas");
    				const context = croppedCanvas.getContext("2d");
    				const imageSize = Math.min(canvas.width, canvas.height);
    				croppedCanvas.width = imageSize;
    				croppedCanvas.height = imageSize;
    				context.drawImage(
    					canvas,
    					(canvas.width - imageSize) / 2,
    					(canvas.height - imageSize) / 2,
    					imageSize,
    					imageSize,
    					0,
    					0,
    					imageSize,
    					imageSize
    				);
    				const tempLink = document.createElement("a");
    				tempLink.href = croppedCanvas.toDataURL("image/png");
    				tempLink.download = formattedTime + "-Sunny水印.png";
    				tempLink.style.display = "none";
    				document.body.appendChild(tempLink);
    				tempLink.click();
    				document.body.removeChild(tempLink);
    				croppedCanvas.toBlob(blob => {
    					navigator.clipboard.write([
    						new ClipboardItem({
    							"image/png": blob
    						})
    					]);
    				});
    			});
    	});

// UA、设备信息展示
    document.getElementById("ua")
    	.innerText = navigator.userAgent;
    document.getElementById("info")
    	.innerText = navigator.deviceMemory + "GB " + navigator.hardwareConcurrency + "核CPU " + navigator.language + " " + navigator.platform + "平台 " + screen.width + "x" + screen.height + "分辨率";
    switch (navigator.connection.type) {
    	case "wifi":
    		document.getElementById("info")
    			.innerText += " WLAN";
    		break;
    	case "cellular":
    		document.getElementById("info")
    			.innerText += " 移动数据";
    		break;
    	default:
    		if (navigator.onLine) {
    			document.getElementById("info")
    				.innerText += " 该浏览器不支持获取当前网络类型";
    		}
    }

// 音乐播放器（包含缓存处理、其他文件展示）
    const audio = document.getElementById("audio");
    const code = document.getElementById("code");
    const image = document.getElementById("image");
    const scheduleInput = document.getElementById("scheduleTime");
    const checkbox = document.getElementById("myCheckbox");

    let currentIndex = 0;
    let isPlaying = false;
    let isRandomMode = false;
    let scheduledTime = "";
    let previousCachedValue = localStorage.getItem('playbackStatus');
    let timers;
    var startTime = new Date();

    audio.addEventListener("ended", function() {
    	isPlaying = true;
    	nextSong();
    });

    window.addEventListener('load', function() {
    	const playbackStatus = {
    		currentIndex: currentIndex,
    		isRandomMode: isRandomMode,
    		isChecked: checkbox.checked,
    		scheduledTime: scheduledTime,
    	};
    	const encodedStatus = btoa(JSON.stringify(playbackStatus));
    	localStorage.setItem('playbackStatus', encodedStatus);
    	code.innerText = encodedStatus;
    	setInterval(function() {
    		savePlaybackStatus();
    	}, 1000);
    });

    audio.addEventListener("play", function() {
    	isPlaying = true;
    	document.title = "当前播放：" + getSongNameFromSrc(songspre[currentIndex].src) + "▷";
    	title.textContent = "当前播放：" + getSongNameFromSrc(songspre[currentIndex].src) + "▷";
    });

    audio.addEventListener("pause", function() {
    	isPlaying = false;
    	document.title = "当前选中：" + getSongNameFromSrc(songspre[currentIndex].src) + "♪";
    	title.textContent = "当前选中：" + getSongNameFromSrc(songspre[currentIndex].src) + "♪";
    });

    scheduleInput.addEventListener('change', function() {
    	scheduledTime = scheduleInput.value;
    	alert("定时播放已设置为" + scheduledTime + "，您可以随时更改所有配置。\n右侧复选框勾选时将在执行前提醒。\n长按时间选择器进入定时计划控制台。");
    });

    function startTimer() {
    	timers = setTimeout(function() {
    		var userinput = prompt("定时计划控制台：\n输入数字设定为该分钟数后播放或暂停。\n输入“清空”将定时计划清空。");
    		if (userinput !== null && !isNaN(userinput) && userinput !== "") {
    			var currentTime = new Date();
    			var schedulededTime = new Date(currentTime.getTime() + userinput * 60000);
    			scheduleInput.value = schedulededTime.toTimeString()
    				.slice(0, 5);
    			scheduledTime = scheduleInput.value;
    			alert("定时计划已设置为" + scheduledTime + "，您可以随时更改所有配置。\n右侧复选框勾选时将在执行前提醒。\n长按时间选择器进入定时计划控制台。");
    		} else if (userinput === "清空") {
    			scheduleInput.value = "";
    			scheduledTime = "";
    		} else if (userinput !== null && userinput !== "") {
    			alert("指令无效，请检查后重试。");
    		}
    	}, 1000);
    }

    function endTimer() {
    	clearTimeout(timers);
    }

    function generateList() {
    	const table = document.getElementById("songList")
    		.getElementsByTagName("tbody")[0];
    	table.innerHTML = "";
    	songspre.forEach(song => {
    		const newRow = table.insertRow();
    		const newCell = newRow.insertCell();
    		const link = document.createElement("a");
    		if (song.directLink) {
    			link.href = song.directLink;
    		} else {
    			link.href = `music/${song.src}.mp3`;
    		}
    		link.textContent = song.src.split(".")[0];
    		link.addEventListener('click', function(e) {
    			e.preventDefault();
    			const userInput = prompt(`请输入对 ${song.src} 的操作（下载请输入“下载”，播放请点击确定）：`);
    			if (userInput === "下载") {
    				const newRow = table.insertRow();
    				const newCell = newRow.insertCell();
    				const downloadLink = document.createElement("a");
    				if (song.directLink) {
    					downloadLink.href = song.directLink;
    				} else {
    					downloadLink.href = `https://dav.sunnyhmz.top:1443/music/${song.src}.mp3`;
    				}
    				downloadLink.textContent = song.src.split(".")[0];
    				downloadLink.click();
    			} else if (userInput === "") {
    				for (let i = 0; i < songs.length; i++) {
    					if (songs[i].src === link.href) {
    						currentIndex = i;
    						updateSong(isPlaying);
    						break;
    					}
    				}
    			} else if (userInput !== null) {
    				alert("指令无效，请检查后重试。");
    			}
    		});
    		newCell.appendChild(link);
    	});
    	imagespre.forEach(image => {
    		const newRow = table.insertRow();
    		const newCell = newRow.insertCell();
    		const link = document.createElement("a");
    		link.href = `assets/image/${image.img}`;
    		link.target = "_blank";
    		link.textContent = image.img.split(".")[0];
    		newCell.appendChild(link);
    	});
    	docuspre.forEach(docu => {
    		const newRow = table.insertRow();
    		const newCell = newRow.insertCell();
    		const link = document.createElement("a");
    		link.href = `https://ow365.cn/?i=33666&ssl=1&furl=https://sunnyhmz.top:8888/assets/document/${docu.src}`;
    		link.target = "_blank";
    		link.textContent = docu.src.split(".")[0];
    		newCell.appendChild(link);
    	});
    }

    function prevSong() {
    	currentIndex--;
    	if (currentIndex < 0) {
    		currentIndex = songs.length - 1;
    	}
    	updateSong(isPlaying);
    }

    function nextSong() {
    	if (isRandomMode) {
    		currentIndex = Math.floor(Math.random() * songs.length);
    	} else {
    		currentIndex = (currentIndex + 1) % songs.length;
    	}
    	updateSong(isPlaying);
    }

    function toggleRandom() {
    	isRandomMode = !isRandomMode;
    	randomButton.innerHTML = isRandomMode ? '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"><path d="M22.5428932,17 C22.6755015,17 22.8026784,17.0526784 22.8964466,17.1464466 C23.0917088,17.3417088 23.0917088,17.6582912 22.8964466,17.8535534 L22.8964466,17.8535534 L20.6035534,20.1464466 C20.5097852,20.2402148 20.3826082,20.2928932 20.25,20.2928932 C19.9738576,20.2928932 19.75,20.0690356 19.75,19.7928932 L19.75,19.7928932 L19.75,18.4971068 L19.5715331,18.4936768 C18.2268663,18.4305831 16.9465051,17.8973966 15.9545082,16.9874231 L15.7600201,16.8004323 L12.768,13.785 L13.829,12.725 L16.8246907,15.7437978 C17.5656306,16.4903728 18.5548505,16.9336053 19.5993305,16.9931152 L19.8412575,17 Z M20.25,3.70710678 C20.3826082,3.70710678 20.5097852,3.7597852 20.6035534,3.85355339 L22.8964466,6.14644661 C23.0917088,6.34170876 23.0917088,6.65829124 22.8964466,6.85355339 C22.8026784,6.94732158 22.6755015,7 22.5428932,7 L19.8412575,7 C18.7085073,7 17.622626,7.45219834 16.8246907,8.25620224 L8.34495239,16.8004323 C7.26539288,17.8882022 5.7962594,18.5 4.26371502,18.5 L1.75,18.5 C1.33578644,18.5 1,18.1642136 1,17.75 C1,17.3357864 1.33578644,17 1.75,17 L4.26371502,17 C5.39646521,17 6.48234648,16.5478017 7.28028177,15.7437978 L15.7600201,7.19956774 C16.8181766,6.13336357 18.250613,5.52444573 19.7501835,5.50072036 L19.75,4.20710678 C19.75,3.93096441 19.9738576,3.70710678 20.25,3.70710678 Z M4.26371502,5.5 C5.70610973,5.5 7.09233423,6.0419385 8.15046426,7.01257686 L8.34495239,7.19956774 L11.364,10.242 L10.303,11.302 L7.28028177,8.25620224 C6.53934186,7.50962719 5.550122,7.06639469 4.50564197,7.00688482 L4.26371502,7 L1.75,7 C1.33578644,7 1,6.66421356 1,6.25 C1,5.87030423 1.28215388,5.55650904 1.64822944,5.50684662 L1.75,5.5 L4.26371502,5.5 Z" id="_path-1"/></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"> <path d="M21.5428932,14.5 C21.6755015,14.5 21.8026784,14.5526784 21.8964466,14.6464466 C22.0917088,14.8417088 22.0917088,15.1582912 21.8964466,15.3535534 L21.8964466,15.3535534 L19.6035534,17.6464466 C19.5097852,17.7402148 19.3826082,17.7928932 19.25,17.7928932 C18.9738576,17.7928932 18.75,17.5690356 18.75,17.2928932 L18.75,17.2928932 L18.75,15.9991068 L2.75,16 C2.37030423,16 2.05650904,15.7178461 2.00684662,15.3517706 L2,15.25 C2,14.8357864 2.33578644,14.5 2.75,14.5 L2.75,14.5 Z M19.25,6.45710678 C19.3826082,6.45710678 19.5097852,6.5097852 19.6035534,6.60355339 L21.8964466,8.89644661 C22.0917088,9.09170876 22.0917088,9.40829124 21.8964466,9.60355339 C21.8026784,9.69732158 21.6755015,9.75 21.5428932,9.75 L2.75,9.75 C2.33578644,9.75 2,9.41421356 2,9 C2,8.58578644 2.33578644,8.25 2.75,8.25 L18.75,8.24910678 L18.75,6.95710678 C18.75,6.68096441 18.9738576,6.45710678 19.25,6.45710678 Z" id="__path-1"/></svg>';
    }

    function getSongNameFromSrc(src) {
    	const fileName = src.split("/")
    		.pop()
    		.split(".")[0];
    	return decodeURIComponent(fileName);
    }

    function updateSong(autoPlay) {
    	audio.src = songs[currentIndex].src;
    	image.src = songs[currentIndex].img;
    	if (autoPlay) {
    		audio.play();
    	} else {
    		audio.pause();
    	}
    	document.title = (autoPlay ? "当前播放：" : "当前选中：") + getSongNameFromSrc(songspre[currentIndex].src) + (autoPlay ? "▷" : "♪");
    	title.textContent = (autoPlay ? "当前播放：" : "当前选中：") + getSongNameFromSrc(songspre[currentIndex].src) + (autoPlay ? "▷" : "♪");
    }

    function checkSchedule() {
    	const now = new Date();
    	const month = now.getMonth() + 1;
    	const date = now.getDate();
    	const hour = now.getHours();
    	const minute = now.getMinutes();
    	const second = now.getSeconds();
    	const weekday = ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"];
    	const formattedMonth = month < 10 ? `0${month}` : month;
    	const formattedDate = date < 10 ? `0${date}` : date;
    	const formattedHour = hour < 10 ? `0${hour}` : hour;
    	const formattedMinute = minute < 10 ? `0${minute}` : minute;
    	const formattedSecond = second < 10 ? `0${second}` : second;
    	const formattedTime = `${now.getFullYear()}年${formattedMonth}月${formattedDate}日 ${formattedHour}:${formattedMinute}:${formattedSecond} ${weekday[now.getDay()]}`;
    	var timeDiff = Math.floor((now - startTime) / 1000);
    	var minutes = Math.floor(timeDiff / 60);
    	var seconds = timeDiff % 60;
    	document.getElementById("time")
    		.innerText = formattedTime;
    	if (minutes < 10) {
    		minutes = "0" + minutes;
    	}
    	if (seconds < 10) {
    		seconds = "0" + seconds;
    	}
    	document.getElementById("timer")
    		.innerHTML = minutes + "分" + seconds + "秒";
    	if (scheduledTime) {
    		const currentTime = new Date();
    		const currentHours = String(currentTime.getHours())
    			.padStart(2, "0");
    		const currentMinutes = String(currentTime.getMinutes())
    			.padStart(2, "0");
    		if (`${currentHours}:${currentMinutes}` === scheduledTime) {
    			if (checkbox.checked) {
    				alert("已到达定时时间，点击确定后开始执行。");
    				if (isPlaying) {
    		        audio.pause();
    	            } else {
    	        	audio.play();
                	}
    				scheduledTime = null;
    			} else {
    				if (isPlaying) {
    		        audio.pause();
    	            } else {
    	        	audio.play();
                	}
    				scheduledTime = null;
    			}
    		}
    	}
    }

    function savePlaybackStatus() {
    	const playbackStatus = {
    		currentIndex: currentIndex,
    		isRandomMode: isRandomMode,
    		isChecked: checkbox.checked,
    		scheduledTime: scheduledTime,
    	};
    	const encodedStatus = btoa(JSON.stringify(playbackStatus));
    	localStorage.setItem('playbackStatus', encodedStatus);
    	const cachedValue = localStorage.getItem('playbackStatus');
    	if (cachedValue !== previousCachedValue) {
    		if (code) {
    			code.innerText = cachedValue;
    		}
    		previousCachedValue = cachedValue;
    	}
    }

    function loadPlaybackStatus() {
    	const encodedStatus = localStorage.getItem('playbackStatus');
    	if (encodedStatus) {
    		const decodedStatus = atob(encodedStatus);
    		const status = JSON.parse(decodedStatus);
    		currentIndex = status.currentIndex;
    		isRandomMode = status.isRandomMode;
    		checkbox.checked = status.isChecked;
    		scheduledTime = status.scheduledTime;
    		scheduleInput.value = status.scheduledTime;
    		updateSong(isPlaying);
    		randomButton.innerHTML = isRandomMode ? '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"><path d="M22.5428932,17 C22.6755015,17 22.8026784,17.0526784 22.8964466,17.1464466 C23.0917088,17.3417088 23.0917088,17.6582912 22.8964466,17.8535534 L22.8964466,17.8535534 L20.6035534,20.1464466 C20.5097852,20.2402148 20.3826082,20.2928932 20.25,20.2928932 C19.9738576,20.2928932 19.75,20.0690356 19.75,19.7928932 L19.75,19.7928932 L19.75,18.4971068 L19.5715331,18.4936768 C18.2268663,18.4305831 16.9465051,17.8973966 15.9545082,16.9874231 L15.7600201,16.8004323 L12.768,13.785 L13.829,12.725 L16.8246907,15.7437978 C17.5656306,16.4903728 18.5548505,16.9336053 19.5993305,16.9931152 L19.8412575,17 Z M20.25,3.70710678 C20.3826082,3.70710678 20.5097852,3.7597852 20.6035534,3.85355339 L22.8964466,6.14644661 C23.0917088,6.34170876 23.0917088,6.65829124 22.8964466,6.85355339 C22.8026784,6.94732158 22.6755015,7 22.5428932,7 L19.8412575,7 C18.7085073,7 17.622626,7.45219834 16.8246907,8.25620224 L8.34495239,16.8004323 C7.26539288,17.8882022 5.7962594,18.5 4.26371502,18.5 L1.75,18.5 C1.33578644,18.5 1,18.1642136 1,17.75 C1,17.3357864 1.33578644,17 1.75,17 L4.26371502,17 C5.39646521,17 6.48234648,16.5478017 7.28028177,15.7437978 L15.7600201,7.19956774 C16.8181766,6.13336357 18.250613,5.52444573 19.7501835,5.50072036 L19.75,4.20710678 C19.75,3.93096441 19.9738576,3.70710678 20.25,3.70710678 Z M4.26371502,5.5 C5.70610973,5.5 7.09233423,6.0419385 8.15046426,7.01257686 L8.34495239,7.19956774 L11.364,10.242 L10.303,11.302 L7.28028177,8.25620224 C6.53934186,7.50962719 5.550122,7.06639469 4.50564197,7.00688482 L4.26371502,7 L1.75,7 C1.33578644,7 1,6.66421356 1,6.25 C1,5.87030423 1.28215388,5.55650904 1.64822944,5.50684662 L1.75,5.5 L4.26371502,5.5 Z" id="_path-1"/></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"> <path d="M21.5428932,14.5 C21.6755015,14.5 21.8026784,14.5526784 21.8964466,14.6464466 C22.0917088,14.8417088 22.0917088,15.1582912 21.8964466,15.3535534 L21.8964466,15.3535534 L19.6035534,17.6464466 C19.5097852,17.7402148 19.3826082,17.7928932 19.25,17.7928932 C18.9738576,17.7928932 18.75,17.5690356 18.75,17.2928932 L18.75,17.2928932 L18.75,15.9991068 L2.75,16 C2.37030423,16 2.05650904,15.7178461 2.00684662,15.3517706 L2,15.25 C2,14.8357864 2.33578644,14.5 2.75,14.5 L2.75,14.5 Z M19.25,6.45710678 C19.3826082,6.45710678 19.5097852,6.5097852 19.6035534,6.60355339 L21.8964466,8.89644661 C22.0917088,9.09170876 22.0917088,9.40829124 21.8964466,9.60355339 C21.8026784,9.69732158 21.6755015,9.75 21.5428932,9.75 L2.75,9.75 C2.33578644,9.75 2,9.41421356 2,9 C2,8.58578644 2.33578644,8.25 2.75,8.25 L18.75,8.24910678 L18.75,6.95710678 C18.75,6.68096441 18.9738576,6.45710678 19.25,6.45710678 Z" id="__path-1"/></svg>';
    	}
    }

    function loadCache() {
    	const cacheString = prompt("请输入缓存代码：");
    	if (cacheString !== null) {
    		const trimmedCacheString = cacheString.trim();
    		if (trimmedCacheString.length > 0) {
    			try {
    				const decodedStatus = atob(trimmedCacheString);
    				const status = JSON.parse(decodedStatus);
    				currentIndex = status.currentIndex;
    				isRandomMode = status.isRandomMode;
    				checkbox.checked = status.isChecked;
    				scheduledTime = status.scheduledTime;
    				scheduleInput.value = status.scheduledTime;
    				updateSong(isPlaying);
    				randomButton.innerHTML = isRandomMode ? '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"><path d="M22.5428932,17 C22.6755015,17 22.8026784,17.0526784 22.8964466,17.1464466 C23.0917088,17.3417088 23.0917088,17.6582912 22.8964466,17.8535534 L22.8964466,17.8535534 L20.6035534,20.1464466 C20.5097852,20.2402148 20.3826082,20.2928932 20.25,20.2928932 C19.9738576,20.2928932 19.75,20.0690356 19.75,19.7928932 L19.75,19.7928932 L19.75,18.4971068 L19.5715331,18.4936768 C18.2268663,18.4305831 16.9465051,17.8973966 15.9545082,16.9874231 L15.7600201,16.8004323 L12.768,13.785 L13.829,12.725 L16.8246907,15.7437978 C17.5656306,16.4903728 18.5548505,16.9336053 19.5993305,16.9931152 L19.8412575,17 Z M20.25,3.70710678 C20.3826082,3.70710678 20.5097852,3.7597852 20.6035534,3.85355339 L22.8964466,6.14644661 C23.0917088,6.34170876 23.0917088,6.65829124 22.8964466,6.85355339 C22.8026784,6.94732158 22.6755015,7 22.5428932,7 L19.8412575,7 C18.7085073,7 17.622626,7.45219834 16.8246907,8.25620224 L8.34495239,16.8004323 C7.26539288,17.8882022 5.7962594,18.5 4.26371502,18.5 L1.75,18.5 C1.33578644,18.5 1,18.1642136 1,17.75 C1,17.3357864 1.33578644,17 1.75,17 L4.26371502,17 C5.39646521,17 6.48234648,16.5478017 7.28028177,15.7437978 L15.7600201,7.19956774 C16.8181766,6.13336357 18.250613,5.52444573 19.7501835,5.50072036 L19.75,4.20710678 C19.75,3.93096441 19.9738576,3.70710678 20.25,3.70710678 Z M4.26371502,5.5 C5.70610973,5.5 7.09233423,6.0419385 8.15046426,7.01257686 L8.34495239,7.19956774 L11.364,10.242 L10.303,11.302 L7.28028177,8.25620224 C6.53934186,7.50962719 5.550122,7.06639469 4.50564197,7.00688482 L4.26371502,7 L1.75,7 C1.33578644,7 1,6.66421356 1,6.25 C1,5.87030423 1.28215388,5.55650904 1.64822944,5.50684662 L1.75,5.5 L4.26371502,5.5 Z" id="_path-1"/></svg>' : '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="40" viewBox="0 0 24 24" version="1.1"> <path d="M21.5428932,14.5 C21.6755015,14.5 21.8026784,14.5526784 21.8964466,14.6464466 C22.0917088,14.8417088 22.0917088,15.1582912 21.8964466,15.3535534 L21.8964466,15.3535534 L19.6035534,17.6464466 C19.5097852,17.7402148 19.3826082,17.7928932 19.25,17.7928932 C18.9738576,17.7928932 18.75,17.5690356 18.75,17.2928932 L18.75,17.2928932 L18.75,15.9991068 L2.75,16 C2.37030423,16 2.05650904,15.7178461 2.00684662,15.3517706 L2,15.25 C2,14.8357864 2.33578644,14.5 2.75,14.5 L2.75,14.5 Z M19.25,6.45710678 C19.3826082,6.45710678 19.5097852,6.5097852 19.6035534,6.60355339 L21.8964466,8.89644661 C22.0917088,9.09170876 22.0917088,9.40829124 21.8964466,9.60355339 C21.8026784,9.69732158 21.6755015,9.75 21.5428932,9.75 L2.75,9.75 C2.33578644,9.75 2,9.41421356 2,9 C2,8.58578644 2.33578644,8.25 2.75,8.25 L18.75,8.24910678 L18.75,6.95710678 C18.75,6.68096441 18.9738576,6.45710678 19.25,6.45710678 Z" id="__path-1"/></svg>';
    			} catch (error) {
    				alert("恢复缓存时发生错误，请检查代码是否完整。");
    			}
    		} else {
    			alert("输入不能为空，请重新输入。");
    		}
    	}
    }

// 猜数字、接龙数据转换、在线播放器
    var 答案, 猜测次数;

    function 猜数字() {
    	答案 = Math.floor(Math.random() * 100) + 1;
    	猜测次数 = 0;
    	if (保密 == "1") {
    		console.log(答案);
    	}
    	document.getElementById("guessResult")
    		.innerHTML = "<p>猜数字[1,100]游戏</p>";
    }

    function 提交猜测() {
    	if (保密 == "1") {
    		console.log(答案);
    	}
    	var 猜测 = parseInt(document.getElementById("RResult")
    		.value);
    	if (isNaN(猜测)) {
    		document.getElementById("guessResult")
    			.innerHTML = "<p>请输入一个有效的数字</p>";
    	} else {
    		猜测次数 += 1;
    		if (猜测 < 答案) {
    			document.getElementById("guessResult")
    				.innerHTML = "<p>第" + 猜测次数 + "次猜测：" + 猜测 + "太小了</p>";
    		} else if (猜测 > 答案) {
    			document.getElementById("guessResult")
    				.innerHTML = "<p>第" + 猜测次数 + "次猜测：" + 猜测 + "太大了</p>";
    		} else {
    			document.getElementById("guessResult")
    				.innerHTML = "<p>恭喜！你在第" + 猜测次数 + "次猜测中猜对了数字" + 答案 + "</p>";
    		}
    		document.getElementById("RResult")
    			.value = "";
    	}
    }

    function convertData() {
    	var lines = document.getElementById("RResult")
    		.value.split("\n");
    	var outputArray = [];
    	for (var i = 0; i < lines.length; i++) {
    		var line = lines[i].trim();
    		if (line !== "") {
    			var parts = line.split(/\d+\.\s*/);
    			if (parts.length > 1) {
    				outputArray.push(parts[1]);
    			}
    		}
    	}
    	var outputText = outputArray.join(",");
    	document.getElementById("RResult")
    		.value = outputText;
    }

    function playVideo() {
    	var videoPlayer = document.getElementById("videoPlayer");
    	var videoElement = document.createElement("video");
    	videoElement.controls = true;
    	videoElement.src = document.getElementById("RResult")
    		.value;;
    	while (videoPlayer.firstChild) {
    		videoPlayer.removeChild(videoPlayer.firstChild);
    	}
    	videoPlayer.appendChild(videoElement);
    }

// 图片缩放
	function handleFileSelect(event) {
            var file = event.target.files[0];
            var reader = new FileReader();
            reader.onload = function (e) {
                var img = document.createElement("img");
                img.src = e.target.result;
                img.onload = function () {
                    var canvas1 = document.createElement("canvas");
                    var ctx1 = canvas1.getContext("2d");
                    canvas1.width = 114;
                    canvas1.height = 114;
                    ctx1.drawImage(img, 0, 0, 114, 114);
                    var canvas2 = document.createElement("canvas");
                    var ctx2 = canvas2.getContext("2d");
                    canvas2.width = 80;
                    canvas2.height = 80;
                    ctx2.drawImage(img, 0, 0, 80, 80);
                    var canvas3 = document.createElement("canvas");
                    var ctx3 = canvas3.getContext("2d");
                    canvas3.width = 128;
                    canvas3.height = 128;
                    ctx3.drawImage(img, 0, 0, 128, 128);
                    var pngData1 = canvas1.toDataURL("image/png");
                    var pngData2 = canvas2.toDataURL("image/png");
                    var pngData3 = canvas3.toDataURL("image/png");
                    var downloadLink1 = document.createElement("a");
                    downloadLink1.href = pngData1;
                    downloadLink1.download = "icon.png";
                    downloadLink1.click();
                    var downloadLink2 = document.createElement("a");
                    downloadLink2.href = pngData2;
                    downloadLink2.download = "icon_small.png";
                    downloadLink2.click();
                    var downloadLink3 = document.createElement("a");
                    downloadLink3.href = pngData3;
                    downloadLink3.download = "hinas.png";
                    downloadLink3.click();
                };
            };
            reader.readAsDataURL(file);
        }

</script>
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js?v=1.4.1"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<link rel="stylesheet" type="text/css" href="assets/style/home.min.css">